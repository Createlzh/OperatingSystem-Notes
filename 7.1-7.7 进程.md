# 7.1-7.7 进程

[TOC]

### 进程的定义

* **进程**：一个具有一定独立的功能的**程序**在一个数据集合的一次**动态执行过程**

* **程序**：程序是静态的

  > 源码通过编译与连接得到的可执行文件，仍是静态的
  >
  > 把它加载到内存中，通过CPU执行程序中的一条条指令才是一次动态执行过程



### 进程的组成

* 程序的代码
* 程序处理的数据
* 程序计数器（寄存器中的值），指示下一条将运行的指令
* 一组通用的寄存器的当前值，栈，堆；
* 一组系统资源（包括打开的文件，内存，网络等等）

> 总之，进程包含了正在运行的一个程序的所有状态信息



### 进程与程序的联系

- 程序是产生进程的基础：

  > 程序的代码指定限制了进程完成的功能。

- 程序的每次运行构成不同的进程：

  > 程序只有一份，但是可以多次执行，虽然程序代码一样，但是进程处理的数据、获得的资源不一样，最后执行的效果也可能不一样

- 进程是程序功能的体现

  > 虽然输入的不同可能导致输出的不同，但功能体是一致的

- 进程与程序是多对多的关系：

  - 一个程序可以对应多个进程；
  - 通过调用关系，一个进程可以包括多个程序



### 进程与程序的区别

- 程序是静态的，进程是动态的

- 程序是代码的集合，进程是程序的执行，进程具有核心态/用户态

  > 进程在执行过程中，有些特定功能需要操作系统提供，进程向OS发出请求，OS代表进程在内核中执行

- 程序是永久的，可以长久保存；进程是暂时的，进程是一个状态变化的过程

- 进程与程序组成不同：进程包含了程序，数据和进程控制块（即进程状态信息）

* 实例：

  > ![进程与程序的关系：类比1](.\pics\jincheng1.png)



### 进程的特点：

1. **动态性**：可动态地创建，结束进程

2. **并发性**：进程可以被独立地调度并占用CPU执行

   > - **并发**：一段时间内有多个进程在执行，
   >
   >   > 一个CPU一个时刻只能执行一个进程，但是一小段时间内CPU可以调度执行多个进程，看起来就像很多进程在一起执行
   >
   > - 并行：一个时刻有多个进程在执行，需要多个CPU才能进行并行

3. **独立性**：不同进程的工作不互相影响

   - 进程的执行时间可能会被别的进行影响
   - 但是进程的正确性不会受影响：数据，指令不会被影响，最终运行结果也不受影响
   - OS通过页表，使得不同应用程序访问不同的地址空间，当应用程序访问越过其自身的地址空间时，会产生缺页异常、页错误

4. **制约性**：因访问共享数据/资源或进程间同步产生制约

   > 比如一个进程需要另一个进程完成后才能继续执行



### 进程控制结构

* **进程控制块**：`PCB`（Process Control Block）

  > 程序=算法+数据结构，PCB就是描述进程的数据结构

  * 操作系统管理控制进程运行所用的信息集合
  * OS为每个进程维护了一个`PCB`，来描述进程的基本情况以及运行变化的过程
  * `PCB`是进程存在的唯一标志，进程与`PCB`一一对应，同时创建，同时结束

* **使用进程控制块**：
  * 进程的创建：为该进程生成一个`PCB`
  * 进程的终止：回收它的`PCB`
  * 进程的组织管理：通过对`PCB`的组织管理来实现

* 进程控制块的三大类信息：

  1. 进程标识信息

     > 如本进程的标识，本进程的产生者标识（父进程标识），用户标识

  2. 处理机状态信息保存区：保存进程的运行现场信息

     * 用户可见寄存器：用户程序可以使用的数据，地址等寄存器。
     * 控制和状态寄存器：如程序计数器，程序状态字（PSW）
     * 栈指针：过程调用/系统调用/中断处理和返回时需要用到它

  3. 进程控制信息：